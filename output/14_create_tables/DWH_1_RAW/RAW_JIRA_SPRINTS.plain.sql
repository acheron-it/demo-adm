/**
 * Derived from template: sf_create_table.sql.j2
 *
 * This script solely creates an external table
 *
 * Jinja variables to set:
 *  - var_env_list: ARRAY e.g. ["T"], ["T","A"], ["T","A","P"]
 *  - var_context: STRING e.g. "DWH"
 *  - var_sch: STRING e.g. "INF_CUSTOMER"
 *  - var_tab: STRING e.g. "TAB_ORDER"
 *  - var_seq (optional): STRING e.g. "TAB_ORDER_SEQ"
 *  - var_col_list: LIST<col>
 *     - <col>: object with attributes
 *              - "col_type",
 *              - "col_not_null" (optional),
 *              - "col_default" (optional),
 *              - "col_comment" (optional)
 **/



/**
 * ARRANGE
 */
USE ROLE      IDENTIFIER('RL_DWH_T_ADMIN');
  USE DATABASE  IDENTIFIER('DB_DWH_T');
  USE WAREHOUSE IDENTIFIER('WH_DWH_T_ELT');
  USE SCHEMA    IDENTIFIER('DWH_1_RAW');
USE ROLE      IDENTIFIER('RL_DWH_T_ELT');
  USE DATABASE  IDENTIFIER('DB_DWH_T');
  USE WAREHOUSE IDENTIFIER('WH_DWH_T_ELT');
  USE SCHEMA    IDENTIFIER('DWH_1_RAW');

/**
 * ACT - Create table
 */
USE ROLE      IDENTIFIER('RL_DWH_T_ADMIN');
  USE DATABASE  IDENTIFIER('DB_DWH_T');
  USE SCHEMA    IDENTIFIER('DWH_1_RAW');
  CREATE TABLE IF NOT EXISTS IDENTIFIER('RAW_JIRA_SPRINTS') (
    META_FILENAME               VARCHAR NOT NULL,
    META_ROW_NUMBER             VARCHAR NOT NULL,
    C001                        VARCHAR,
    C002                        VARCHAR,
    C003                        VARCHAR,
    C004                        VARCHAR,
    C005                        VARCHAR,
    C006                        VARCHAR,
    C007                        VARCHAR,
    C008                        VARCHAR,
    C009                        VARCHAR,
    C010                        VARCHAR,
    C011                        VARCHAR,
    C012                        VARCHAR,
    C013                        VARCHAR,
    C014                        VARCHAR,
    C015                        VARCHAR,
    C016                        VARCHAR,
    C017                        VARCHAR,
    C018                        VARCHAR,
    C019                        VARCHAR,
    C020                        VARCHAR,
    C021                        VARCHAR,
    C022                        VARCHAR,
    C023                        VARCHAR,
    C024                        VARCHAR,
    C025                        VARCHAR,
    C026                        VARCHAR,
    C027                        VARCHAR,
    C028                        VARCHAR,
    C029                        VARCHAR,
    C030                        VARCHAR,
    C031                        VARCHAR,
    C032                        VARCHAR,
    C033                        VARCHAR,
    C034                        VARCHAR,
    C035                        VARCHAR,
    C036                        VARCHAR,
    C037                        VARCHAR,
    C038                        VARCHAR,
    C039                        VARCHAR,
    C040                        VARCHAR,
    C041                        VARCHAR,
    C042                        VARCHAR,
    C043                        VARCHAR,
    C044                        VARCHAR,
    C045                        VARCHAR,
    C046                        VARCHAR,
    C047                        VARCHAR,
    C048                        VARCHAR,
    C049                        VARCHAR,
    C050                        VARCHAR,
    C051                        VARCHAR,
    C052                        VARCHAR,
    C053                        VARCHAR,
    C054                        VARCHAR,
    C055                        VARCHAR,
    C056                        VARCHAR,
    C057                        VARCHAR,
    C058                        VARCHAR,
    C059                        VARCHAR,
    C060                        VARCHAR,
    C061                        VARCHAR,
    C062                        VARCHAR,
    C063                        VARCHAR,
    C064                        VARCHAR,
    C065                        VARCHAR,
    C066                        VARCHAR,
    C067                        VARCHAR,
    C068                        VARCHAR,
    C069                        VARCHAR,
    C070                        VARCHAR,
    C071                        VARCHAR,
    C072                        VARCHAR,
    C073                        VARCHAR,
    C074                        VARCHAR,
    C075                        VARCHAR,
    C076                        VARCHAR,
    C077                        VARCHAR,
    C078                        VARCHAR,
    C079                        VARCHAR,
    C080                        VARCHAR,
    C081                        VARCHAR,
    C082                        VARCHAR,
    C083                        VARCHAR,
    C084                        VARCHAR,
    C085                        VARCHAR,
    C086                        VARCHAR,
    C087                        VARCHAR,
    C088                        VARCHAR,
    C089                        VARCHAR,
    C090                        VARCHAR,
    C091                        VARCHAR,
    C092                        VARCHAR,
    C093                        VARCHAR,
    C094                        VARCHAR,
    C095                        VARCHAR,
    C096                        VARCHAR,
    C097                        VARCHAR,
    C098                        VARCHAR,
    C099                        VARCHAR,
    C100                        VARCHAR,
    C101                        VARCHAR,
    C102                        VARCHAR,
    C103                        VARCHAR,
    C104                        VARCHAR,
    C105                        VARCHAR,
    C106                        VARCHAR,
    C107                        VARCHAR,
    C108                        VARCHAR,
    C109                        VARCHAR,
    C110                        VARCHAR,
    C111                        VARCHAR,
    C112                        VARCHAR,
    C113                        VARCHAR,
    C114                        VARCHAR,
    C115                        VARCHAR,
    C116                        VARCHAR,
    C117                        VARCHAR,
    C118                        VARCHAR,
    C119                        VARCHAR,
    C120                        VARCHAR,
    C121                        VARCHAR,
    C122                        VARCHAR,
    C123                        VARCHAR,
    C124                        VARCHAR,
    C125                        VARCHAR,
    C126                        VARCHAR,
    C127                        VARCHAR,
    C128                        VARCHAR,
    C129                        VARCHAR,
    C130                        VARCHAR,
    C131                        VARCHAR,
    C132                        VARCHAR,
    C133                        VARCHAR,
    C134                        VARCHAR,
    C135                        VARCHAR,
    C136                        VARCHAR,
    C137                        VARCHAR,
    C138                        VARCHAR,
    C139                        VARCHAR,
    C140                        VARCHAR,
    C141                        VARCHAR,
    C142                        VARCHAR,
    C143                        VARCHAR,
    C144                        VARCHAR,
    C145                        VARCHAR,
    C146                        VARCHAR,
    C147                        VARCHAR,
    C148                        VARCHAR,
    C149                        VARCHAR,
    C150                        VARCHAR,
    C151                        VARCHAR,
    C152                        VARCHAR,
    C153                        VARCHAR,
    C154                        VARCHAR,
    C155                        VARCHAR,
    C156                        VARCHAR,
    C157                        VARCHAR,
    C158                        VARCHAR,
    C159                        VARCHAR,
    C160                        VARCHAR,
    C161                        VARCHAR,
    C162                        VARCHAR,
    C163                        VARCHAR,
    C164                        VARCHAR,
    C165                        VARCHAR,
    C166                        VARCHAR,
    C167                        VARCHAR,
    C168                        VARCHAR,
    C169                        VARCHAR,
    C170                        VARCHAR,
    C171                        VARCHAR,
    C172                        VARCHAR,
    C173                        VARCHAR,
    C174                        VARCHAR,
    C175                        VARCHAR,
    C176                        VARCHAR,
    C177                        VARCHAR,
    C178                        VARCHAR,
    C179                        VARCHAR,
    C180                        VARCHAR,
    C181                        VARCHAR,
    C182                        VARCHAR,
    C183                        VARCHAR,
    C184                        VARCHAR,
    C185                        VARCHAR,
    C186                        VARCHAR,
    C187                        VARCHAR,
    C188                        VARCHAR,
    C189                        VARCHAR,
    C190                        VARCHAR,
    C191                        VARCHAR,
    C192                        VARCHAR,
    C193                        VARCHAR,
    C194                        VARCHAR,
    C195                        VARCHAR,
    C196                        VARCHAR,
    C197                        VARCHAR,
    C198                        VARCHAR,
    C199                        VARCHAR,
    C200                        VARCHAR,
    C201                        VARCHAR,
    C202                        VARCHAR,
    C203                        VARCHAR,
    C204                        VARCHAR,
    C205                        VARCHAR,
    C206                        VARCHAR,
    C207                        VARCHAR,
    C208                        VARCHAR,
    C209                        VARCHAR,
    C210                        VARCHAR,
    C211                        VARCHAR,
    C212                        VARCHAR,
    C213                        VARCHAR,
    C214                        VARCHAR,
    C215                        VARCHAR,
    C216                        VARCHAR,
    C217                        VARCHAR,
    C218                        VARCHAR,
    C219                        VARCHAR,
    C220                        VARCHAR,
    C221                        VARCHAR,
    C222                        VARCHAR,
    C223                        VARCHAR,
    C224                        VARCHAR,
    C225                        VARCHAR,
    C226                        VARCHAR,
    C227                        VARCHAR,
    C228                        VARCHAR,
    C229                        VARCHAR,
    C230                        VARCHAR,
    C231                        VARCHAR,
    C232                        VARCHAR,
    C233                        VARCHAR,
    C234                        VARCHAR,
    C235                        VARCHAR,
    C236                        VARCHAR,
    C237                        VARCHAR,
    C238                        VARCHAR,
    C239                        VARCHAR,
    C240                        VARCHAR,
    C241                        VARCHAR,
    C242                        VARCHAR,
    C243                        VARCHAR,
    C244                        VARCHAR,
    C245                        VARCHAR,
    C246                        VARCHAR,
    C247                        VARCHAR,
    C248                        VARCHAR,
    C249                        VARCHAR,
    C250                        VARCHAR,
    C251                        VARCHAR,
    C252                        VARCHAR,
    C253                        VARCHAR,
    C254                        VARCHAR,
    C255                        VARCHAR,
    C256                        VARCHAR,
    C257                        VARCHAR,
    C258                        VARCHAR,
    C259                        VARCHAR,
    C260                        VARCHAR,
    C261                        VARCHAR,
    C262                        VARCHAR,
    C263                        VARCHAR,
    C264                        VARCHAR,
    C265                        VARCHAR,
    C266                        VARCHAR,
    C267                        VARCHAR,
    C268                        VARCHAR,
    C269                        VARCHAR,
    C270                        VARCHAR,
    C271                        VARCHAR,
    C272                        VARCHAR,
    C273                        VARCHAR,
    C274                        VARCHAR,
    C275                        VARCHAR,
    C276                        VARCHAR,
    C277                        VARCHAR,
    C278                        VARCHAR,
    C279                        VARCHAR,
    C280                        VARCHAR,
    C281                        VARCHAR,
    C282                        VARCHAR,
    C283                        VARCHAR,
    C284                        VARCHAR,
    C285                        VARCHAR,
    C286                        VARCHAR,
    C287                        VARCHAR,
    C288                        VARCHAR,
    C289                        VARCHAR,
    C290                        VARCHAR,
    C291                        VARCHAR,
    C292                        VARCHAR,
    C293                        VARCHAR,
    C294                        VARCHAR,
    C295                        VARCHAR,
    C296                        VARCHAR,
    C297                        VARCHAR,
    C298                        VARCHAR,
    C299                        VARCHAR,
    C300                        VARCHAR,
    C301                        VARCHAR,
    C302                        VARCHAR,
    C303                        VARCHAR,
    C304                        VARCHAR,
    C305                        VARCHAR,
    C306                        VARCHAR,
    C307                        VARCHAR,
    C308                        VARCHAR,
    C309                        VARCHAR,
    C310                        VARCHAR,
    C311                        VARCHAR,
    C312                        VARCHAR,
    C313                        VARCHAR,
    C314                        VARCHAR,
    C315                        VARCHAR,
    C316                        VARCHAR,
    C317                        VARCHAR,
    C318                        VARCHAR,
    C319                        VARCHAR,
    C320                        VARCHAR,
    C321                        VARCHAR,
    C322                        VARCHAR,
    C323                        VARCHAR,
    C324                        VARCHAR,
    C325                        VARCHAR,
    C326                        VARCHAR,
    C327                        VARCHAR,
    C328                        VARCHAR,
    C329                        VARCHAR,
    C330                        VARCHAR,
    C331                        VARCHAR,
    C332                        VARCHAR,
    C333                        VARCHAR,
    C334                        VARCHAR,
    C335                        VARCHAR,
    C336                        VARCHAR,
    C337                        VARCHAR,
    C338                        VARCHAR,
    C339                        VARCHAR,
    C340                        VARCHAR,
    C341                        VARCHAR,
    C342                        VARCHAR,
    C343                        VARCHAR,
    C344                        VARCHAR,
    C345                        VARCHAR,
    C346                        VARCHAR,
    C347                        VARCHAR,
    C348                        VARCHAR,
    C349                        VARCHAR,
    C350                        VARCHAR,
    C351                        VARCHAR,
    C352                        VARCHAR,
    C353                        VARCHAR,
    C354                        VARCHAR,
    C355                        VARCHAR,
    C356                        VARCHAR,
    C357                        VARCHAR,
    C358                        VARCHAR,
    C359                        VARCHAR,
    C360                        VARCHAR,
    C361                        VARCHAR,
    C362                        VARCHAR,
    C363                        VARCHAR,
    C364                        VARCHAR,
    C365                        VARCHAR,
    C366                        VARCHAR,
    C367                        VARCHAR,
    C368                        VARCHAR,
    C369                        VARCHAR,
    C370                        VARCHAR,
    C371                        VARCHAR,
    C372                        VARCHAR,
    C373                        VARCHAR,
    C374                        VARCHAR,
    C375                        VARCHAR,
    C376                        VARCHAR,
    C377                        VARCHAR,
    C378                        VARCHAR,
    C379                        VARCHAR,
    C380                        VARCHAR,
    C381                        VARCHAR,
    C382                        VARCHAR,
    C383                        VARCHAR,
    C384                        VARCHAR,
    C385                        VARCHAR,
    C386                        VARCHAR,
    C387                        VARCHAR,
    C388                        VARCHAR,
    C389                        VARCHAR,
    C390                        VARCHAR,
    C391                        VARCHAR,
    C392                        VARCHAR,
    C393                        VARCHAR,
    C394                        VARCHAR,
    C395                        VARCHAR,
    C396                        VARCHAR,
    C397                        VARCHAR,
    C398                        VARCHAR,
    C399                        VARCHAR,
    C400                        VARCHAR,
    C401                        VARCHAR,
    C402                        VARCHAR,
    C403                        VARCHAR,
    C404                        VARCHAR,
    C405                        VARCHAR,
    C406                        VARCHAR,
    C407                        VARCHAR,
    C408                        VARCHAR,
    C409                        VARCHAR,
    C410                        VARCHAR,
    C411                        VARCHAR,
    C412                        VARCHAR,
    C413                        VARCHAR,
    C414                        VARCHAR,
    C415                        VARCHAR,
    C416                        VARCHAR,
    C417                        VARCHAR,
    C418                        VARCHAR,
    C419                        VARCHAR,
    C420                        VARCHAR,
    C421                        VARCHAR,
    C422                        VARCHAR,
    C423                        VARCHAR,
    C424                        VARCHAR,
    C425                        VARCHAR,
    C426                        VARCHAR,
    C427                        VARCHAR,
    C428                        VARCHAR,
    C429                        VARCHAR,
    C430                        VARCHAR,
    C431                        VARCHAR,
    C432                        VARCHAR,
    C433                        VARCHAR,
    C434                        VARCHAR,
    C435                        VARCHAR,
    C436                        VARCHAR,
    C437                        VARCHAR,
    C438                        VARCHAR,
    C439                        VARCHAR,
    C440                        VARCHAR,
    C441                        VARCHAR,
    C442                        VARCHAR,
    C443                        VARCHAR,
    C444                        VARCHAR,
    C445                        VARCHAR,
    C446                        VARCHAR,
    C447                        VARCHAR,
    C448                        VARCHAR,
    C449                        VARCHAR,
    C450                        VARCHAR,
    C451                        VARCHAR,
    C452                        VARCHAR,
    C453                        VARCHAR,
    C454                        VARCHAR,
    C455                        VARCHAR,
    C456                        VARCHAR,
    C457                        VARCHAR,
    C458                        VARCHAR,
    C459                        VARCHAR,
    C460                        VARCHAR,
    C461                        VARCHAR,
    C462                        VARCHAR,
    C463                        VARCHAR,
    C464                        VARCHAR,
    C465                        VARCHAR,
    C466                        VARCHAR,
    C467                        VARCHAR,
    C468                        VARCHAR,
    C469                        VARCHAR,
    C470                        VARCHAR,
    C471                        VARCHAR,
    C472                        VARCHAR,
    C473                        VARCHAR,
    C474                        VARCHAR,
    C475                        VARCHAR,
    C476                        VARCHAR,
    C477                        VARCHAR,
    C478                        VARCHAR,
    C479                        VARCHAR,
    C480                        VARCHAR,
    C481                        VARCHAR,
    C482                        VARCHAR,
    C483                        VARCHAR,
    C484                        VARCHAR,
    C485                        VARCHAR,
    C486                        VARCHAR,
    C487                        VARCHAR,
    C488                        VARCHAR,
    C489                        VARCHAR,
    C490                        VARCHAR,
    C491                        VARCHAR,
    C492                        VARCHAR,
    C493                        VARCHAR,
    C494                        VARCHAR,
    C495                        VARCHAR,
    C496                        VARCHAR,
    C497                        VARCHAR,
    C498                        VARCHAR,
    C499                        VARCHAR,
    C500                        VARCHAR
    );

/**
 * ASSERT
 */
USE ROLE      IDENTIFIER('RL_DWH_T_ELT');
  USE WAREHOUSE IDENTIFIER('WH_DWH_T_ELT');
  USE DATABASE  IDENTIFIER('DB_DWH_T');
  USE SCHEMA    IDENTIFIER('DWH_1_RAW');
  SELECT * FROM IDENTIFIER('RAW_JIRA_SPRINTS') LIMIT 5;


